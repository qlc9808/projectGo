<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.oracle.projectGo.BoardMapper">

    <select id="boardCount" resultType="int">
        select count(*)
        from board a, users b
        where a.userId = b.id
        and a.commentIndent = 0
        <if test="keyword != null and keyword != ''">
            and a.title like '%' || #{keyword} || '%'
        </if>
        <if test="userId != null and userId != ''">
            and a.userId = #{userId}
        </if>
    </select>

    <select id="noticeboardCount" resultType="int">
        select count(*)
        from board a, users b
        where a.userId = b.id
        and a.commentIndent = 0
        and a.boardType = 1
        <if test="keyword != null and keyword != ''">
            and a.title like '%' || #{keyword} || '%'
        </if>
        <if test="userId != null and userId != ''">
            and a.userId = #{userId}
        </if>
    </select>

    <select id="listnoticeBoard" resultType="Board">
        select *
        from (
        select rownum rn, c.*
        from (
        select a.id, a.userId, a.boardType, a.title, a.content, a.status, a.readCount,
        a.fileName, a.fileSize, a.filePath, a.createdAt, a.updatedAt
        from board a
        where a.boardType = 1
        <if test="status != null and status != ''">
            and a.status = #{status}
        </if>
        <if test="keyword != null and keyword != ''">
            and a.title like '%' || #{keyword} || '%'
        </if>
        ) c
        )
        where rn between #{start} and #{end}
    </select>

    <insert id="InsertnoticeBoard" parameterType="Board">
        INSERT INTO contents(id, title, content, status, readCount, fileName, fileSize, filePath, createdAt)
        VALUES(contents_id_seq.nextval, #{title}, #{content}, #{status}, 0, #{fileName}, #{fileSize},
               #{filePath}, sysdate)
    </insert>

    <update id="noticeUpdate" parameterType="Board">
        UPDATE board
        SET title = #{title},	content = #{content}, status = #{status}
        WHERE userId = #{userId}
    </update>

    <select id="noticeDetail" resultType="Board" parameterType="int">
        SELECT *
        FROM BOARD
        WHERE boardType 1
    </select>

    <delete id="noticeDelete" parameterType="int">
        update board
        where  boardType 1
    </delete>







</mapper>